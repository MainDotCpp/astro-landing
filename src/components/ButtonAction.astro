<script>
// 初始化全局混合模态框（只初始化一次）
if (!window.hybridModalInitialized) {
  window.hybridModalInitialized = true
  function redirect(link) {
    try {
      gtag_report_conversion()
    }
    catch (error) {
      console.error(error)
    }
    finally {
      setTimeout(() => {
        window.location.href = link
      }, 100)
    }
  }

  // 等待DOM加载完成
  document.addEventListener('DOMContentLoaded', () => {
    const modal = document.getElementById('global-hybrid-modal')
    document.querySelectorAll('.global-modal-band').forEach((btn) => {
      btn.addEventListener('click', () => {
        modal.style.display = 'none'
        redirect(band_link)
      })
    })
    document.querySelectorAll('.global-modal-kakao').forEach((btn) => {
      btn.addEventListener('click', () => {
        modal.style.display = 'none'
        redirect(kakao_link)
      })
    })

    // 点击外部关闭模态框
    if (modal) {
      modal.addEventListener('click', (e) => {
        if (e.target === modal) {
          modal.style.display = 'none'
        }
      })
    }
  })
}

// 为当前按钮添加点击事件
document.addEventListener('DOMContentLoaded', () => {
  const buttons = document.querySelectorAll(`.cta-button`)

  buttons.forEach((button) => {
    button.addEventListener('click', (e) => {
      e.preventDefault()
      const modal = document.getElementById('global-hybrid-modal')
      if (modal) {
        modal.style.display = 'flex'
      }
    })
  })
})
</script>
